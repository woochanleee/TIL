# jwt

참고: [리액트를 다루는 기술 - 개정판]

JWT는 JSON Web Token의 약자로, 데이터가 JSON으로 이루어져있는 토큰을 의미한다. 클라이언트와 서버가 서로 안전하게 정보를 주고받을 수 있도록 웹 표준으로 정의된 기술이다.

## 세션 기반 인증과 토큰 기반 인증의 차이

사용자의 로그인 상태를 서버에서 처리할때 사용하는 대표적인 방법으로 세션, 토큰 쿠키 등이 있다. 여기서는 세션과 토큰에 차이를 알아보겠다.

### 세션 기반 인증 시스템

- 세션 기반으로 인증 시스템을 만든다는 것은 쉽게 말해, 서버가 사용가 로그인 중임을 기억하고 있는 뜻이다.
  ![세션 기반 인증 시스템](https://img1.daumcdn.net/thumb/R800x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F994BEA345B53368401)

1. 사용자가 로그인을 함
2. 서버는 디비에서 사용자 정보를 확인하고 세션 id를 발급함
3. 발급된 id를 주로 브라우져 쿠키🍪에 저장함
4. 사용자가 다른 요청을 보낼 때 서버는 세션 저장소에서 세션을 조회한 후 로그인 여부를 결정학고 작업 처리후 응답을 함

> #### 단점

1. 서버를 확장하기 번거로워진다.
   - 만약 서버의 인스턴스가 여러 개가 된다면, 모든 서버끼리 같은 세션을 공유해야 하므로 세션 전용 데이터베이스를 만들어야 할 뿐 아니라 신경 써야 할 것도 많다.

- 그렇다고 세션 기반 인증이 무조건 좋지 않은건 아니다.
- 잘 설계하면 충분히 좋은 시스템이 될 수 있다.

### 토큰 기반 인증 시스템

- 토큰은 로그인 이후 서버가 만들어 주는 문자열 이다.
- 해당 문자열 안에는 사용자의 로그인 정보, 서버에서 발급 되었음을 증명하는 서명이 들어 있다.
- 서명 데이터는 해싱 알고리즘을 통해 만들어지는데, 주로 HMAC SHA256 혹은 RSA SHA256 알고리즘이 사용된다.

#### 특징

1. 서버에서 만들어 준 토큰은 서명이 있기 때문에 **무결성**이 보장된다.
   - 무결성이란 정보가 변경되거나 위조되지 않았음을 의미하는 성질이다.
2. 서버에서 사용자 로그인 정보를 기억하기 위해 사용하는 리소스가 적다는 장점이 있다.
3. 사용자 쪽에서 로그인 상태를 지닌 토큰을 가지고 있으므로 서버의 확장성이 매우 높다.
4. 서버의 인스턴스가 여러 개로 늘어나도 사용자의 로그인 상태를 공유하고 있을 필요가 없다.

#### 작동원리

![토큰 기반 인증 시스템](https://lh3.googleusercontent.com/proxy/-Ps7fRCa88_EC-5np1wbDsxyXSz1-2RPtD8RsqMKoAkrZ7e23-vpufqib3CYnCifymOx5QncxhKgr-VU-nqQjhEj2FB8uM9pUmhBNtgR10j2_6wivaap8hiXvHka8V_tmdQE0lqecoVBz-Bdt9vx3qOWBB0GFgkYZlexUWZKOJNkhUn6HF5sZoQCGznajCurQlMKu5i63UwvLRlBAOjPVrtiCOFH0EPoi-sdrtNTVQMc2vlUr2FOb1eyVxqR9wMmKZKwqzALz4ajmVGpiiNZxHulzDiNVSQsFPEpSDH9)

1. 사용자가 로그인을 함
2. 서버에서 사용자에게 해당 사용자의 정보를 지닌 토큰을 발급해줌
3. 사용자가 API를 요청할때 토큰과 함께 요청함
4. 서버는 해당 토큰이 유효한지 검사하고, 결과에 따라 작업을 처리하고 응답함
